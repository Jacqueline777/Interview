node{
 def app
 
    stage('Clone Repo')
    {
     final scmVars = checkout(scm)
     env.BRANCH_NAME = scm.GIT_BRANCH
     env.SHORT_COMMIT ="${scmVars.GIT_COMMIT[0..7]}"
     
        env.GIT_REPO_NAME = scmVars.GIT_URL.replaceFirst(/^.*\/([^\/]+?).git$/, '$1')
     echo "clone"}
     stage ('Clean Maven')
    {
     withMaven(maven:'maven_3_0_0_M3'){
    ssh mvn clean
      echo "clean maven"}}
 
    stage('Run tests')
    { withMaven(maven:'maven_3_0_0_M3'){
     ssh mvn test
     echo "run tests"}}
 
    stage('Run sonarqube report')
  { echo "run report"}
    
}
def version()
{
    pom = readMavenPom file: 'pom.xml'
    return pom.version
}
  
